% function [tau] = computed_torque(q, dq, a)
% q1 = q(1);
% q2 = q(2);
% q3 = q(3);
% 
% dq1 = dq(1);
% dq2 = dq(2);
% dq3 = dq(3);
% 
% ddq1 = a(1);
% ddq2 = a(2);
% ddq3 = a(3);
% tau = [0 0 0];
% tau(1) = 0.25336*ddq1 + 14.622*dq1 + 1.4631*sign(dq1) + 4.5577*dq2^2*sin(q2) - 5.7199*dq1*dq2 - 1.3165*dq1*dq3 - 1.936*ddq1*cos(q3) - 4.5577*ddq2*cos(q2) - 0.22221*ddq1*sin(q3) - 2.0438*ddq2*sin(q2) + 4.7652*ddq1*cos(q2)^2 - 0.088104*ddq1*cos(q3)^2 - 2.0438*dq2^2*cos(q2) + 1.936*dq1*dq2*sin(q3) + 1.936*dq1*dq3*sin(q3) + 0.17621*ddq1*cos(q2)^2*cos(q3)^2 + 11.44*dq1*dq2*cos(q2)^2 + 2.633*dq1*dq2*cos(q3)^2 + 2.633*dq1*dq3*cos(q2)^2 + 2.633*dq1*dq3*cos(q3)^2 + 2.6215*ddq2*cos(q2)*cos(q3) + 2.6215*ddq3*cos(q2)*cos(q3) + 5.7199*ddq1*cos(q2)*sin(q2) + 1.3165*ddq1*cos(q3)*sin(q3) + 0.25847*ddq2*cos(q2)*sin(q3) + 0.25847*ddq2*cos(q3)*sin(q2) + 0.25847*ddq3*cos(q2)*sin(q3) + 0.25847*ddq3*cos(q3)*sin(q2) - 2.6215*ddq2*sin(q2)*sin(q3) - 2.6215*ddq3*sin(q2)*sin(q3) + 1.936*ddq1*cos(q2)^2*cos(q3) + 0.25847*dq2^2*cos(q2)*cos(q3) + 0.25847*dq3^2*cos(q2)*cos(q3) + 0.22221*ddq1*cos(q2)^2*sin(q3) - 2.6215*dq2^2*cos(q2)*sin(q3) - 2.6215*dq2^2*cos(q3)*sin(q2) - 2.6215*dq3^2*cos(q2)*sin(q3) - 2.6215*dq3^2*cos(q3)*sin(q2) - 0.25847*dq2^2*sin(q2)*sin(q3) - 0.25847*dq3^2*sin(q2)*sin(q3) - 0.22221*dq1*dq2*cos(q3) - 0.22221*dq1*dq3*cos(q3) + 0.44442*dq1*dq2*cos(q2)^2*cos(q3) + 0.22221*dq1*dq3*cos(q2)^2*cos(q3) - 3.872*dq1*dq2*cos(q2)^2*sin(q3) - 1.936*dq1*dq3*cos(q2)^2*sin(q3) + 0.22221*ddq1*cos(q2)*cos(q3)*sin(q2) - 1.936*ddq1*cos(q2)*sin(q2)*sin(q3) - 5.266*dq1*dq2*cos(q2)^2*cos(q3)^2 - 5.266*dq1*dq3*cos(q2)^2*cos(q3)^2 - 2.633*ddq1*cos(q2)*cos(q3)^2*sin(q2) - 2.633*ddq1*cos(q2)^2*cos(q3)*sin(q3) + 0.51694*dq2*dq3*cos(q2)*cos(q3) - 9.5303*dq1*dq2*cos(q2)*sin(q2) + 0.17621*dq1*dq3*cos(q2)*sin(q2) + 0.17621*dq1*dq2*cos(q3)*sin(q3) + 0.17621*dq1*dq3*cos(q3)*sin(q3) - 5.2431*dq2*dq3*cos(q2)*sin(q3) - 5.2431*dq2*dq3*cos(q3)*sin(q2) - 0.51694*dq2*dq3*sin(q2)*sin(q3) - 0.35242*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - 0.35242*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3) - 0.35242*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) - 0.35242*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) - 0.17621*ddq1*cos(q2)*cos(q3)*sin(q2)*sin(q3) - 3.872*dq1*dq2*cos(q2)*cos(q3)*sin(q2) - 1.936*dq1*dq3*cos(q2)*cos(q3)*sin(q2) - 0.44442*dq1*dq2*cos(q2)*sin(q2)*sin(q3) - 0.22221*dq1*dq3*cos(q2)*sin(q2)*sin(q3) + 5.266*dq1*dq2*cos(q2)*cos(q3)*sin(q2)*sin(q3) + 5.266*dq1*dq3*cos(q2)*cos(q3)*sin(q2)*sin(q3) + 0.081603;
% tau(2) = 2.3568*ddq3 - 2.1712*ddq2 + 34.535*dq2 + 33.207*cos(q2) + 4.7082*sign(dq2) - 2.4921*sin(q2) - 0.968*dq1^2*sin(q3) + 0.968*dq3^2*sin(q3) + 0.39066*cos(q2)*cos(q3) - 3.4036*cos(q2)*sin(q3) - 3.4036*cos(q3)*sin(q2) - 0.39066*sin(q2)*sin(q3) - 5.7199*dq1^2*cos(q2)^2 - 1.3165*dq1^2*cos(q3)^2 - 4.5577*ddq1*cos(q2) - 1.936*ddq2*cos(q3) - 0.968*ddq3*cos(q3) - 2.0438*ddq1*sin(q2) - 0.22221*ddq2*sin(q3) - 0.11111*ddq3*sin(q3) + 2.8599*dq1^2 + 0.11111*dq1^2*cos(q3) - 0.11111*dq3^2*cos(q3) + 1.936*dq2*dq3*sin(q3) - 0.22221*dq1^2*cos(q2)^2*cos(q3) + 1.936*dq1^2*cos(q2)^2*sin(q3) + 2.6215*ddq1*cos(q2)*cos(q3) + 0.25847*ddq1*cos(q2)*sin(q3) + 0.25847*ddq1*cos(q3)*sin(q2) + 2.633*dq1^2*cos(q2)^2*cos(q3)^2 - 2.6215*ddq1*sin(q2)*sin(q3) + 4.7652*dq1^2*cos(q2)*sin(q2) - 0.088104*dq1^2*cos(q3)*sin(q3) - 0.22221*dq2*dq3*cos(q3) + 0.17621*dq1^2*cos(q2)*cos(q3)^2*sin(q2) + 0.17621*dq1^2*cos(q2)^2*cos(q3)*sin(q3) + 1.936*dq1^2*cos(q2)*cos(q3)*sin(q2) + 0.22221*dq1^2*cos(q2)*sin(q2)*sin(q3) - 2.633*dq1^2*cos(q2)*cos(q3)*sin(q2)*sin(q3) - 28.428;
% tau(3) = 2.3568*ddq2 + 2.3568*ddq3 + 43.569*dq3 + 3.8366*sign(dq3) - 0.968*dq1^2*sin(q3) - 0.968*dq2^2*sin(q3) + 0.39066*cos(q2)*cos(q3) - 3.4036*cos(q2)*sin(q3) - 3.4036*cos(q3)*sin(q2) - 0.39066*sin(q2)*sin(q3) - 1.3165*dq1^2*cos(q2)^2 - 1.3165*dq1^2*cos(q3)^2 - 0.968*ddq2*cos(q3) - 0.11111*ddq2*sin(q3) + 0.65825*dq1^2 + 0.11111*dq1^2*cos(q3) + 0.11111*dq2^2*cos(q3) - 0.11111*dq1^2*cos(q2)^2*cos(q3) + 0.968*dq1^2*cos(q2)^2*sin(q3) + 2.6215*ddq1*cos(q2)*cos(q3) + 0.25847*ddq1*cos(q2)*sin(q3) + 0.25847*ddq1*cos(q3)*sin(q2) + 2.633*dq1^2*cos(q2)^2*cos(q3)^2 - 2.6215*ddq1*sin(q2)*sin(q3) - 0.088104*dq1^2*cos(q2)*sin(q2) - 0.088104*dq1^2*cos(q3)*sin(q3) + 0.17621*dq1^2*cos(q2)*cos(q3)^2*sin(q2) + 0.17621*dq1^2*cos(q2)^2*cos(q3)*sin(q3) + 0.968*dq1^2*cos(q2)*cos(q3)*sin(q2) + 0.11111*dq1^2*cos(q2)*sin(q2)*sin(q3) - 2.633*dq1^2*cos(q2)*cos(q3)*sin(q2)*sin(q3) + 0.21852;
% 
% end

function [tau] = computed_torque(q, dq, a)
q1 = q(1);
q2 = q(2);
q3 = q(3);

dq1 = dq(1);
dq2 = dq(2);
dq3 = dq(3);

ddq1 = a(1);
ddq2 = a(2);
ddq3 = a(3);

tau = [0 0 0];
tau(1) = 0.25336*ddq1 + 14.622*dq1 + 4.5577*dq2^2*sin(q2) - 5.7199*dq1*dq2 - 1.3165*dq1*dq3 - 1.936*ddq1*cos(q3) - 4.5577*ddq2*cos(q2) - 0.22221*ddq1*sin(q3) - 2.0438*ddq2*sin(q2) + 4.7652*ddq1*cos(q2)^2 - 0.088104*ddq1*cos(q3)^2 - 2.0438*dq2^2*cos(q2) + 1.936*dq1*dq2*sin(q3) + 1.936*dq1*dq3*sin(q3) + 0.17621*ddq1*cos(q2)^2*cos(q3)^2 + 11.44*dq1*dq2*cos(q2)^2 + 2.633*dq1*dq2*cos(q3)^2 + 2.633*dq1*dq3*cos(q2)^2 + 2.633*dq1*dq3*cos(q3)^2 + 2.6215*ddq2*cos(q2)*cos(q3) + 2.6215*ddq3*cos(q2)*cos(q3) + 5.7199*ddq1*cos(q2)*sin(q2) + 1.3165*ddq1*cos(q3)*sin(q3) + 0.25847*ddq2*cos(q2)*sin(q3) + 0.25847*ddq2*cos(q3)*sin(q2) + 0.25847*ddq3*cos(q2)*sin(q3) + 0.25847*ddq3*cos(q3)*sin(q2) - 2.6215*ddq2*sin(q2)*sin(q3) - 2.6215*ddq3*sin(q2)*sin(q3) + 1.936*ddq1*cos(q2)^2*cos(q3) + 0.25847*dq2^2*cos(q2)*cos(q3) + 0.25847*dq3^2*cos(q2)*cos(q3) + 0.22221*ddq1*cos(q2)^2*sin(q3) - 2.6215*dq2^2*cos(q2)*sin(q3) - 2.6215*dq2^2*cos(q3)*sin(q2) - 2.6215*dq3^2*cos(q2)*sin(q3) - 2.6215*dq3^2*cos(q3)*sin(q2) - 0.25847*dq2^2*sin(q2)*sin(q3) - 0.25847*dq3^2*sin(q2)*sin(q3) - 0.22221*dq1*dq2*cos(q3) - 0.22221*dq1*dq3*cos(q3) + 0.44442*dq1*dq2*cos(q2)^2*cos(q3) + 0.22221*dq1*dq3*cos(q2)^2*cos(q3) - 3.872*dq1*dq2*cos(q2)^2*sin(q3) - 1.936*dq1*dq3*cos(q2)^2*sin(q3) + 0.22221*ddq1*cos(q2)*cos(q3)*sin(q2) - 1.936*ddq1*cos(q2)*sin(q2)*sin(q3) - 5.266*dq1*dq2*cos(q2)^2*cos(q3)^2 - 5.266*dq1*dq3*cos(q2)^2*cos(q3)^2 - 2.633*ddq1*cos(q2)*cos(q3)^2*sin(q2) - 2.633*ddq1*cos(q2)^2*cos(q3)*sin(q3) + 0.51694*dq2*dq3*cos(q2)*cos(q3) - 9.5303*dq1*dq2*cos(q2)*sin(q2) + 0.17621*dq1*dq3*cos(q2)*sin(q2) + 0.17621*dq1*dq2*cos(q3)*sin(q3) + 0.17621*dq1*dq3*cos(q3)*sin(q3) - 5.2431*dq2*dq3*cos(q2)*sin(q3) - 5.2431*dq2*dq3*cos(q3)*sin(q2) - 0.51694*dq2*dq3*sin(q2)*sin(q3) - 0.35242*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - 0.35242*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3) - 0.35242*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) - 0.35242*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) - 0.17621*ddq1*cos(q2)*cos(q3)*sin(q2)*sin(q3) - 3.872*dq1*dq2*cos(q2)*cos(q3)*sin(q2) - 1.936*dq1*dq3*cos(q2)*cos(q3)*sin(q2) - 0.44442*dq1*dq2*cos(q2)*sin(q2)*sin(q3) - 0.22221*dq1*dq3*cos(q2)*sin(q2)*sin(q3) + 5.266*dq1*dq2*cos(q2)*cos(q3)*sin(q2)*sin(q3) + 5.266*dq1*dq3*cos(q2)*cos(q3)*sin(q2)*sin(q3) + 0.081603;
tau(2) = 2.3568*ddq3 - 2.1712*ddq2 + 34.535*dq2 + 33.207*cos(q2) - 2.4921*sin(q2) - 0.968*dq1^2*sin(q3) + 0.968*dq3^2*sin(q3) + 0.39066*cos(q2)*cos(q3) - 3.4036*cos(q2)*sin(q3) - 3.4036*cos(q3)*sin(q2) - 0.39066*sin(q2)*sin(q3) - 5.7199*dq1^2*cos(q2)^2 - 1.3165*dq1^2*cos(q3)^2 - 4.5577*ddq1*cos(q2) - 1.936*ddq2*cos(q3) - 0.968*ddq3*cos(q3) - 2.0438*ddq1*sin(q2) - 0.22221*ddq2*sin(q3) - 0.11111*ddq3*sin(q3) + 2.8599*dq1^2 + 0.11111*dq1^2*cos(q3) - 0.11111*dq3^2*cos(q3) + 1.936*dq2*dq3*sin(q3) - 0.22221*dq1^2*cos(q2)^2*cos(q3) + 1.936*dq1^2*cos(q2)^2*sin(q3) + 2.6215*ddq1*cos(q2)*cos(q3) + 0.25847*ddq1*cos(q2)*sin(q3) + 0.25847*ddq1*cos(q3)*sin(q2) + 2.633*dq1^2*cos(q2)^2*cos(q3)^2 - 2.6215*ddq1*sin(q2)*sin(q3) + 4.7652*dq1^2*cos(q2)*sin(q2) - 0.088104*dq1^2*cos(q3)*sin(q3) - 0.22221*dq2*dq3*cos(q3) + 0.17621*dq1^2*cos(q2)*cos(q3)^2*sin(q2) + 0.17621*dq1^2*cos(q2)^2*cos(q3)*sin(q3) + 1.936*dq1^2*cos(q2)*cos(q3)*sin(q2) + 0.22221*dq1^2*cos(q2)*sin(q2)*sin(q3) - 2.633*dq1^2*cos(q2)*cos(q3)*sin(q2)*sin(q3) - 28.428;
tau(3) = 2.3568*ddq2 + 2.3568*ddq3 + 43.569*dq3 - 0.968*dq1^2*sin(q3) - 0.968*dq2^2*sin(q3) + 0.39066*cos(q2)*cos(q3) - 3.4036*cos(q2)*sin(q3) - 3.4036*cos(q3)*sin(q2) - 0.39066*sin(q2)*sin(q3) - 1.3165*dq1^2*cos(q2)^2 - 1.3165*dq1^2*cos(q3)^2 - 0.968*ddq2*cos(q3) - 0.11111*ddq2*sin(q3) + 0.65825*dq1^2 + 0.11111*dq1^2*cos(q3) + 0.11111*dq2^2*cos(q3) - 0.11111*dq1^2*cos(q2)^2*cos(q3) + 0.968*dq1^2*cos(q2)^2*sin(q3) + 2.6215*ddq1*cos(q2)*cos(q3) + 0.25847*ddq1*cos(q2)*sin(q3) + 0.25847*ddq1*cos(q3)*sin(q2) + 2.633*dq1^2*cos(q2)^2*cos(q3)^2 - 2.6215*ddq1*sin(q2)*sin(q3) - 0.088104*dq1^2*cos(q2)*sin(q2) - 0.088104*dq1^2*cos(q3)*sin(q3) + 0.17621*dq1^2*cos(q2)*cos(q3)^2*sin(q2) + 0.17621*dq1^2*cos(q2)^2*cos(q3)*sin(q3) + 0.968*dq1^2*cos(q2)*cos(q3)*sin(q2) + 0.11111*dq1^2*cos(q2)*sin(q2)*sin(q3) - 2.633*dq1^2*cos(q2)*cos(q3)*sin(q2)*sin(q3) + 0.21852;

end